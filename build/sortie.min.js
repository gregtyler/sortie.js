/*!
 * Sortie.js v0.2.0
 * An inoffensive table sorter for developers
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.Sortie=e()}(this,function(){"use strict";function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}function e(t){return t.split("").reverse().join("")}function r(t,e){var r={};return"undefined"==typeof e&&(e="yyyy-mm-dd"),e.replace(/(dd|mm|yyyy|hh|ii)/g,function(e,n,o){r[n]=t.substr(o,n.length)}),new Date(r.yyyy||0,r.mm-1||0,r.dd||1,r.hh||0,r.ii||0,r.ss||0)}function n(t){return t.textContent}function o(t,e){function r(){for(var r=t.attributes,n={},o=0,i=r.length;i>o;o++){var s=r[o];if("data-sortie"===s.name.substr(0,11)&&s.name.length>11){var u=s.name.toLowerCase().replace(/-/g,"");n[u.substr(11)]=s.value}}return Object.assign(!0,{},a,e,n)}function n(){e=r();var n;if(n="undefined"!=typeof e.sort?e.sort:t.getAttribute("data-sortie"),null===n)return!1;"string"==typeof n&&(n=n.split("|")),n.length>p.length&&console.error("Sortie config error: Too many sort columns specified"),t.setAttribute("aria-atomic",!0),t.setAttribute("aria-live","polite"),t.setAttribute("aria-relevant","all"),t.setAttribute("role","grid"),t.querySelector("thead").setAttribute("role","rowgroup");for(var a=t.querySelectorAll("thead > tr"),u=0,c=a.length;c>u;u++)a[u].setAttribute("role","row");t.getAttribute("id")||t.setAttribute("id","sortieTable"+1*new Date);for(var l in n)if(n[l]){var d=document.createElement("button");d.style.backgroundColor="transparent",d.style.border="none",d.innerHTML=e.markers.unsorted,d.setAttribute("type","button"),d.setAttribute("aria-controls",t.getAttribute("id"));var v=p[l];v.style.whiteSpace="nowrap",v.style.cursor="pointer",v.addEventListener("click",o(l)),v.setAttribute("data-sortie",!0),v.setAttribute("role","columnheader"),f.set(v,"sortieCompareFunction",s(l,n[l])),f.set(v,"sortieButton",d),v.appendChild(document.createTextNode(" ")),v.appendChild(d),v.addEventListener("sortie:sortAsc",o(l,{dir:"ASC"})),v.addEventListener("sortie:sortDesc",o(l,{dir:"DESC"}))}if(e.initialsort!==!1){var b={};if("D"===e.initialsort.toString().substr(-1,1))b.dir="DESC";else if("A"===e.initialsort.toString().substr(-1,1))b.dir="ASC";else if("-1"===e.initialsort.toString())for(var u=0,c=n.length;c>u;u++)if(n[u]){e.initialsort=u;break}i(e.initialsort,b)}}function o(t,e){return function(){i(t,e)}}function i(r,n){r=parseInt(r,10);var n=Object.assign({},n),o=p[r],i=f.get(o,"sortieButton"),s=Array.prototype.slice.call(l.querySelectorAll("tr"),0),a="undefined"!=typeof n.dir?n.dir:"ASC";c===r&&"ASC"===f.get(o,"sortieDirection")&&"undefined"==typeof n.dir&&(a="DESC"),c=r,f.set(o,"sortieDirection",a),o.setAttribute("aria-sort",a.toLowerCase()+"ending"),s.sort(f.get(o,"sortieCompareFunction")),"DESC"===a?(i.innerHTML=e.markers.desc,s=s.reverse()):i.innerHTML=e.markers.asc;for(var u=0,v=p.length;v>u;u++){var b=p[u];b!==o&&(b.removeAttribute("aria-sort"),b.getAttribute("data-sortie")&&(f.get(b,"sortieButton").innerHTML=e.markers.unsorted))}var y=document.createDocumentFragment();for(var u in s)y.appendChild(s[u]);t.dispatchEvent(d.afterSorted),l.innerHTML="",l.appendChild(y)}function s(t,e){var r=e.split(":"),n=r[0],o=r[1]?r[1].split(","):[],i=u[n];if("function"!=typeof i){console.error('Sortie error: comparison function not found for rule "'+n+'"');var i=function(){return 0}}return function(r,n){var s=r.children[t],a=n.children[t],u=i.call(window,s,a,o);return"r"===e.substr(1,1)?-u:u}}var c,l=t.querySelector("tbody"),p=t.querySelectorAll("thead th");return n(),{sort:i}}function i(t,e){return new o(t,e)}function s(t,e){"string"==typeof t&&(t=[t]);for(var r=0,n=t.length;n>r;r++)u[t[r]]=e}var a={initialsort:-1,markers:{asc:"&#8595;",desc:"&#8593;",unsorted:"&#8597;"}},u={};if("function"!=typeof Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}),Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get){var c=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return c.get.call(this)},set:function(t){return c.set.call(this,t)}})}try{new CustomEvent("test")}catch(l){t.prototype=window.Event.prototype,window.CustomEvent=t}var d={sortAsc:new CustomEvent("sortie:sortAsc"),sortDesc:new CustomEvent("sortie:sortDesc"),afterSorted:new CustomEvent("sortie:afterSorted")},f=function(){function t(t){for(var e=0,r=n.length;r>e;e++)if(n[e].__obj===t)return e;return n.push({__obj:t}),n.length-1}function e(e,r){var o=t(e);return n[o]&&n[o][r]?n[o][r]:null}function r(e,r,o){var i=t(e);"undefined"==typeof n[i]&&(n[i]={}),n[i][r]=o}var n=[];return{get:e,set:r}}();return s(["a","alpha"],function(t,r){var o=n(t).trim(),i=n(r).trim();return"rtl"===t.dir&&(o=e(o)),"rtl"===r.dir&&(i=e(i)),o.localeCompare(i)}),s(["d","date"],function(t,e,o){var i=o[0],s=r(n(t),i),a=r(n(e),i);return s>a?1:a>s?-1:0}),s(["i","int"],function(t,e){var r=parseInt(n(t),10),o=parseInt(n(e),10);return isNaN(o)?isNaN(r)?0:1:isNaN(r)?-1:r-o}),{create:i,events:d,registerComparison:s}});
//# sourceMappingURL=sortie.min.js.map
